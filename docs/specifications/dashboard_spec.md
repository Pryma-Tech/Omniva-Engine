# Omniva Engine — Dashboard & UI Specification

## 1. Overview
The Omniva dashboard is the primary user interface for managing projects and monitoring the clipfarm pipeline. Operators use it to interact with workers, review logs, track clip statuses, manage credentials, and examine cognitive reasoning generated by HaloLux. The UI is minimal and optimized for operational clarity, exposing core functions:
- Project management
- Creator management
- Bot control (start/stop/restart)
- Monitoring & alerts
- Settings and pipeline configuration
- Credential management
- Cognitive insights display (HaloLux narratives)

## 2. Dashboard Architecture
- **Frontend**: Lightweight SPA (React, Vue, or Svelte) with modular components.
- **Backend**: FastAPI service providing REST + WebSocket endpoints that proxy orchestrator data, worker statuses, and cognitive outputs.
- **Real-time updates**: Combination of periodic polling (5–15s) for heavy lists and WebSocket channels for critical signals (worker heartbeats, HaloLux updates).
- **Integrations**:
  - Stardust metadata for provenance traces.
  - Logs table for structured events.
  - Worker status service for queue depth, heartbeats.
  - Upload scheduling service for calendar data.
  - HaloLux cognitive API for interpretability payloads.

Text diagram:
```
[Frontend UI] → [FastAPI Backend] → [Database + Stardust + Logs + Workers + Cognitive Layer]
```

## 3. Pages & Views

### 3.1 Projects Overview Page
- **Display**: List of projects with status (RUNNING/PAUSED/ERROR), total videos scraped, clips processed, upload queue size, last activity timestamp.
- **User controls**: Create project, open project, pause/resume automation per project.
- **Indicators**: Color-coded badges for status, small sparkline showing throughput per project.

### 3.2 Project Detail Page
- **Content**: Project metadata (description, owner, targets), creator roster, worker progress summaries, clip pipeline visualization, latest cognitive insights (e.g., Pantheon votes, Horizon adjustments).
- **Tabs**:
  - Overview (pipeline KPIs, clip funnel).
  - Creators (CRUD, scraping windows, platform tokens).
  - Clips (table of clip states, filters by status).
  - Schedule (calendar view of upcoming posts).
  - Logs (project-scoped log viewer).
  - Settings (project-specific configuration).

### 3.3 Bot Control Page
- **Controls**: Start/stop/restart bot processes, reset failed tasks, trigger manual scrape/upload, flush or rebuild queues.
- **Metrics**: Worker heartbeats, error counts, CPU/GPU load, queue depth per worker.
- **Actions** require confirmation modals and display recent command history.

### 3.4 Logs Viewer
- **Features**: Stream logs from the centralized `logs` table with filters by source, level, date range, worker type.
- **Live tail mode**: WebSocket push for real-time monitoring.
- **UX**: JSON viewer toggle, link to Stardust/HaloLux references for each log entry.

### 3.5 Settings Page
- **Configuration**:
  - Scraping window (default 7 days) per project.
  - Keyword lists, clip length preferences.
  - Posting quotas (1–10 clips/day) and daily schedules.
  - Parallel worker counts and GPU allocation.
  - Storage paths/buckets and lifecycle rules.
  - Notification preferences (email, Slack, PagerDuty).
- Changes persist via FastAPI endpoints and require audit logging.

### 3.6 YouTube Credentials & Channel Branding
- **Display/manage**:
  - OAuth tokens (status, expiration, re-auth flow).
  - Channel selection dropdown (per project).
  - Logo/Banner uploads (v1 manual file upload; v2 note for SDXL generation).
  - Title/description template editor with handlebars-style variables.

### 3.7 HaloLux Interpretability View
- **Purpose**: Present cognitive reasoning chain per clip/job.
- **Data**:
  - Paradox conflict resolutions.
  - Eclipse recovery actions.
  - Pantheon vote summaries.
  - Lattice routing decisions.
  - Horizon long-term adjustments.
  - Zenith final decision notes.
- **UI**: Tree/accordion combined with JSON inspector. Provide copy-to-clipboard for raw payloads.

## 4. UI Components
- `ProjectCard`: status badge, KPI summary, action buttons.
- `CreatorList`: table with platform icons, scraping windows, action menu.
- `WorkerStatusBadge`: heartbeat indicator, load percent, error tooltip.
- `LogTable`: virtualized table with filters, JSON viewer.
- `ClipTimeline`: horizontal pipeline view illustrating clip state transitions.
- `ScheduleCalendar`: week/month calendar with drag-to-reschedule (future).
- `AIExplanationPanel`: renders HaloLux reasoning with highlight states and raw JSON toggle.
- `Modal` components for sensitive actions (stop bot, re-auth credentials, delete project).

## 5. Data Fetching & API Integration
- **Endpoints** (examples):  
  - `GET /api/projects`, `POST /api/projects`  
  - `GET /api/projects/{id}/overview`  
  - `GET /api/logs?project_id=...`  
  - `POST /api/bots/{id}/command` (start/stop/reset)  
  - `GET /api/halolux/explanations?clip_id=...`  
  - `GET /api/schedules/upcoming`  
  - `GET /api/workers/status`
- **Polling/websockets**:
  - Projects overview: poll every 15s.
  - Worker status + heartbeats: WebSocket (fallback to 5s poll).
  - Logs viewer live tail: WebSocket stream.
  - HaloLux insights: on-demand fetch + WebSocket for updates flagged as critical.
- **Error handling**: show toast notifications, fallback to last known state, allow manual refresh. For 401s, prompt re-auth. For 5xx, display contextual message and retry/backoff.
- **State updates**: UI uses optimistic updates for stop/start commands, reconciling with backend responses; long-running tasks display spinner + event log.

## 6. UX Guidelines
- Operational-first: prioritize clarity of state over aesthetic flourish.
- Status colors: green = healthy, yellow = attention, red = error, gray = paused.
- Minimal clutter: collapse advanced settings behind accordions; highlight pipeline progress metrics.
- Provide inline links from UI elements to Stardust/HaloLux artifacts for interpretability.
- Tooltips explain cognitive insights and decision reasons.
- Do not block user interactions during background tasks; show non-blocking progress indicators.

## 7. Wireframe Diagrams

### Projects Overview
```
-----------------------------------------
| Project Name | Status | Videos | Clips |
-----------------------------------------
| BusinessAI   | RUNNING|   42   |  135  |
| FitnessGuru  | PAUSED |   18   |   67  |
| CreatorLab   | ERROR  |    9   |   21  |
-----------------------------------------
[Create Project] [Pause All]
```

### Cognitive Insight Drawer
```
-----------------------------------------
| HaloLux Insight — Clip #12            |
| Decision Trace:                       |
|  Paradox: No conflicts                |
|  Lattice: Priority 0.82 (under-index) |
|  Pantheon Votes:                      |
|    - Strategist: High novelty (0.91)  |
|    - Guardian: Medium virality (0.65) |
|  Horizon: Aligns with Week 6 goals    |
|  Zenith: Approved Edit+Upload         |
-----------------------------------------
| Raw JSON { ... } [Copy]               |
-----------------------------------------
```

## 8. Implementation Notes
- UI can be delivered incrementally—start with projects overview and logs, then add HaloLux panels.
- Handle missing/partial data gracefully: empty states with guidance, skeleton loading indicators.
- HaloLux payloads can be large/structured; JSON viewer must support nested objects and search.
- Support multiple concurrent operator sessions with shared state; consider role-based access (future).
- Ensure accessibility (ARIA labels, keyboard navigation) for operational tasks.
- Document versioning between frontend and backend APIs to avoid drift as modules evolve.

